### OpenCOBOL Test Suite				-*- m4 -*-

## Copyright (C) 2003 Keisuke Nishida
##
## This program is free software; you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation; either version 2, or (at your option)
## any later version.
##
## This program is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with this software; see the file COPYING.  If not, write to
## the Free Software Foundation, Inc., 59 Temple Place, Suite 330,
## Boston, MA 02111-1307 USA


# 2-4-8 big-endian

AT_SETUP([2-4-8 big-endian])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 2-4-8
binary-byteorder: big-endian
])

AT_DATA([dump.c], [
int dump (unsigned char *data)
{
  int i;
  for (i = 0; i < 8; i++)
    printf ("%02x", data[[i]]);
  puts ("");
  return 0;
}
])

AT_CHECK([${CC} -shared -o dump.so dump.c])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 G-P1.
         02 X           PIC 9(1) VALUE 1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P2.
         02 X           PIC 9(2) VALUE 12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P3.
         02 X           PIC 9(3) VALUE 123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P4.
         02 X           PIC 9(4) VALUE 1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P5.
         02 X           PIC 9(5) VALUE 12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P6.
         02 X           PIC 9(6) VALUE 123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P7.
         02 X           PIC 9(7) VALUE 1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P8.
         02 X           PIC 9(8) VALUE 12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P9.
         02 X           PIC 9(9) VALUE 123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P10.
         02 X           PIC 9(10) VALUE 1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P11.
         02 X           PIC 9(11) VALUE 12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P12.
         02 X           PIC 9(12) VALUE 123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P13.
         02 X           PIC 9(13) VALUE 1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P14.
         02 X           PIC 9(14) VALUE 12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P15.
         02 X           PIC 9(15) VALUE 123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P16.
         02 X           PIC 9(16) VALUE 1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P17.
         02 X           PIC 9(17) VALUE 12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P18.
         02 X           PIC 9(18) VALUE 123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N1.
         02 X           PIC S9(1) VALUE -1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N2.
         02 X           PIC S9(2) VALUE -12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N3.
         02 X           PIC S9(3) VALUE -123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N4.
         02 X           PIC S9(4) VALUE -1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N5.
         02 X           PIC S9(5) VALUE -12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N6.
         02 X           PIC S9(6) VALUE -123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N7.
         02 X           PIC S9(7) VALUE -1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N8.
         02 X           PIC S9(8) VALUE -12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N9.
         02 X           PIC S9(9) VALUE -123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N10.
         02 X           PIC S9(10) VALUE -1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N11.
         02 X           PIC S9(11) VALUE -12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N12.
         02 X           PIC S9(12) VALUE -123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N13.
         02 X           PIC S9(13) VALUE -1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N14.
         02 X           PIC S9(14) VALUE -12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N15.
         02 X           PIC S9(15) VALUE -123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N16.
         02 X           PIC S9(16) VALUE -1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N17.
         02 X           PIC S9(17) VALUE -12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N18.
         02 X           PIC S9(18) VALUE -123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       PROCEDURE        DIVISION.
           CALL "dump" USING G-P1.
           CALL "dump" USING G-P2.
           CALL "dump" USING G-P3.
           CALL "dump" USING G-P4.
           CALL "dump" USING G-P5.
           CALL "dump" USING G-P6.
           CALL "dump" USING G-P7.
           CALL "dump" USING G-P8.
           CALL "dump" USING G-P9.
           CALL "dump" USING G-P10.
           CALL "dump" USING G-P11.
           CALL "dump" USING G-P12.
           CALL "dump" USING G-P13.
           CALL "dump" USING G-P14.
           CALL "dump" USING G-P15.
           CALL "dump" USING G-P16.
           CALL "dump" USING G-P17.
           CALL "dump" USING G-P18.
           CALL "dump" USING G-N1.
           CALL "dump" USING G-N2.
           CALL "dump" USING G-N3.
           CALL "dump" USING G-N4.
           CALL "dump" USING G-N5.
           CALL "dump" USING G-N6.
           CALL "dump" USING G-N7.
           CALL "dump" USING G-N8.
           CALL "dump" USING G-N9.
           CALL "dump" USING G-N10.
           CALL "dump" USING G-N11.
           CALL "dump" USING G-N12.
           CALL "dump" USING G-N13.
           CALL "dump" USING G-N14.
           CALL "dump" USING G-N15.
           CALL "dump" USING G-N16.
           CALL "dump" USING G-N17.
           CALL "dump" USING G-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[0001313233343536
000c313233343536
007b313233343536
04d2313233343536
0000303931323334
0001e24031323334
0012d68731323334
00bc614e31323334
075bcd1531323334
00000000499602d2
00000002dfdc1c35
0000001cbe991a14
0000011f71fb04cb
00000b3a73ce2ff2
00007048860ddf79
000462d53c8abac0
002bdc545d6b4b87
01b69b4ba630f34e
ffff313233343536
fff4313233343536
ff85313233343536
fb2e313233343536
ffffcfc731323334
fffe1dc031323334
ffed297931323334
ff439eb231323334
f8a432eb31323334
ffffffffb669fd2e
fffffffd2023e3cb
ffffffe34166e5ec
fffffee08e04fb35
fffff4c58c31d00e
ffff8fb779f22087
fffb9d2ac3754540
ffd423aba294b479
fe4964b459cf0cb2
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[1
12
123
1234
12345
123456
1234567
12345678
123456789
1234567890
12345678901
123456789012
1234567890123
12345678901234
123456789012345
1234567890123456
12345678901234567
123456789012345678
-1
-12
-123
-1234
-12345
-123456
-1234567
-12345678
-123456789
-1234567890
-12345678901
-123456789012
-1234567890123
-12345678901234
-123456789012345
-1234567890123456
-12345678901234567
-123456789012345678
])

AT_CLEANUP


# 2-4-8 native

AT_SETUP([2-4-8 native])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 2-4-8
binary-byteorder: native
])

AT_DATA([dump.c], [
int dump (unsigned char *data)
{
  int i;
  for (i = 0; i < 8; i++)
    printf ("%02x", data[[i]]);
  puts ("");
  return 0;
}
])

AT_CHECK([${CC} -shared -o dump.so dump.c])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 G-P1.
         02 X           PIC 9(1) VALUE 1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P2.
         02 X           PIC 9(2) VALUE 12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P3.
         02 X           PIC 9(3) VALUE 123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P4.
         02 X           PIC 9(4) VALUE 1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P5.
         02 X           PIC 9(5) VALUE 12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P6.
         02 X           PIC 9(6) VALUE 123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P7.
         02 X           PIC 9(7) VALUE 1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P8.
         02 X           PIC 9(8) VALUE 12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P9.
         02 X           PIC 9(9) VALUE 123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P10.
         02 X           PIC 9(10) VALUE 1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P11.
         02 X           PIC 9(11) VALUE 12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P12.
         02 X           PIC 9(12) VALUE 123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P13.
         02 X           PIC 9(13) VALUE 1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P14.
         02 X           PIC 9(14) VALUE 12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P15.
         02 X           PIC 9(15) VALUE 123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P16.
         02 X           PIC 9(16) VALUE 1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P17.
         02 X           PIC 9(17) VALUE 12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P18.
         02 X           PIC 9(18) VALUE 123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N1.
         02 X           PIC S9(1) VALUE -1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N2.
         02 X           PIC S9(2) VALUE -12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N3.
         02 X           PIC S9(3) VALUE -123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N4.
         02 X           PIC S9(4) VALUE -1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N5.
         02 X           PIC S9(5) VALUE -12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N6.
         02 X           PIC S9(6) VALUE -123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N7.
         02 X           PIC S9(7) VALUE -1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N8.
         02 X           PIC S9(8) VALUE -12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N9.
         02 X           PIC S9(9) VALUE -123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N10.
         02 X           PIC S9(10) VALUE -1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N11.
         02 X           PIC S9(11) VALUE -12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N12.
         02 X           PIC S9(12) VALUE -123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N13.
         02 X           PIC S9(13) VALUE -1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N14.
         02 X           PIC S9(14) VALUE -12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N15.
         02 X           PIC S9(15) VALUE -123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N16.
         02 X           PIC S9(16) VALUE -1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N17.
         02 X           PIC S9(17) VALUE -12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N18.
         02 X           PIC S9(18) VALUE -123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       PROCEDURE        DIVISION.
           CALL "dump" USING G-P1.
           CALL "dump" USING G-P2.
           CALL "dump" USING G-P3.
           CALL "dump" USING G-P4.
           CALL "dump" USING G-P5.
           CALL "dump" USING G-P6.
           CALL "dump" USING G-P7.
           CALL "dump" USING G-P8.
           CALL "dump" USING G-P9.
           CALL "dump" USING G-P10.
           CALL "dump" USING G-P11.
           CALL "dump" USING G-P12.
           CALL "dump" USING G-P13.
           CALL "dump" USING G-P14.
           CALL "dump" USING G-P15.
           CALL "dump" USING G-P16.
           CALL "dump" USING G-P17.
           CALL "dump" USING G-P18.
           CALL "dump" USING G-N1.
           CALL "dump" USING G-N2.
           CALL "dump" USING G-N3.
           CALL "dump" USING G-N4.
           CALL "dump" USING G-N5.
           CALL "dump" USING G-N6.
           CALL "dump" USING G-N7.
           CALL "dump" USING G-N8.
           CALL "dump" USING G-N9.
           CALL "dump" USING G-N10.
           CALL "dump" USING G-N11.
           CALL "dump" USING G-N12.
           CALL "dump" USING G-N13.
           CALL "dump" USING G-N14.
           CALL "dump" USING G-N15.
           CALL "dump" USING G-N16.
           CALL "dump" USING G-N17.
           CALL "dump" USING G-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[0100313233343536
0c00313233343536
7b00313233343536
d204313233343536
3930000031323334
40e2010031323334
87d6120031323334
4e61bc0031323334
15cd5b0731323334
d202964900000000
351cdcdf02000000
141a99be1c000000
cb04fb711f010000
f22fce733a0b0000
79df0d8648700000
c0ba8a3cd5620400
874b6b5d54dc2b00
4ef330a64b9bb601
ffff313233343536
f4ff313233343536
85ff313233343536
2efb313233343536
c7cfffff31323334
c01dfeff31323334
7929edff31323334
b29e43ff31323334
eb32a4f831323334
2efd69b6ffffffff
cbe32320fdffffff
ece56641e3ffffff
35fb048ee0feffff
0ed0318cc5f4ffff
8720f279b78fffff
404575c32a9dfbff
79b494a2ab23d4ff
b20ccf59b46449fe
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[1
12
123
1234
12345
123456
1234567
12345678
123456789
1234567890
12345678901
123456789012
1234567890123
12345678901234
123456789012345
1234567890123456
12345678901234567
123456789012345678
-1
-12
-123
-1234
-12345
-123456
-1234567
-12345678
-123456789
-1234567890
-12345678901
-123456789012
-1234567890123
-12345678901234
-123456789012345
-1234567890123456
-12345678901234567
-123456789012345678
])

AT_CLEANUP


# 1-2-4-8 big-endian

AT_SETUP([1-2-4-8 big-endian])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 1-2-4-8
binary-byteorder: big-endian
])

AT_DATA([dump.c], [
int dump (unsigned char *data)
{
  int i;
  for (i = 0; i < 8; i++)
    printf ("%02x", data[[i]]);
  puts ("");
  return 0;
}
])

AT_CHECK([${CC} -shared -o dump.so dump.c])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 G-P1.
         02 X           PIC 9(1) VALUE 1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P2.
         02 X           PIC 9(2) VALUE 12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P3.
         02 X           PIC 9(3) VALUE 123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P4.
         02 X           PIC 9(4) VALUE 1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P5.
         02 X           PIC 9(5) VALUE 12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P6.
         02 X           PIC 9(6) VALUE 123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P7.
         02 X           PIC 9(7) VALUE 1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P8.
         02 X           PIC 9(8) VALUE 12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P9.
         02 X           PIC 9(9) VALUE 123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P10.
         02 X           PIC 9(10) VALUE 1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P11.
         02 X           PIC 9(11) VALUE 12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P12.
         02 X           PIC 9(12) VALUE 123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P13.
         02 X           PIC 9(13) VALUE 1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P14.
         02 X           PIC 9(14) VALUE 12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P15.
         02 X           PIC 9(15) VALUE 123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P16.
         02 X           PIC 9(16) VALUE 1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P17.
         02 X           PIC 9(17) VALUE 12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P18.
         02 X           PIC 9(18) VALUE 123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N1.
         02 X           PIC S9(1) VALUE -1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N2.
         02 X           PIC S9(2) VALUE -12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N3.
         02 X           PIC S9(3) VALUE -123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N4.
         02 X           PIC S9(4) VALUE -1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N5.
         02 X           PIC S9(5) VALUE -12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N6.
         02 X           PIC S9(6) VALUE -123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N7.
         02 X           PIC S9(7) VALUE -1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N8.
         02 X           PIC S9(8) VALUE -12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N9.
         02 X           PIC S9(9) VALUE -123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N10.
         02 X           PIC S9(10) VALUE -1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N11.
         02 X           PIC S9(11) VALUE -12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N12.
         02 X           PIC S9(12) VALUE -123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N13.
         02 X           PIC S9(13) VALUE -1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N14.
         02 X           PIC S9(14) VALUE -12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N15.
         02 X           PIC S9(15) VALUE -123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N16.
         02 X           PIC S9(16) VALUE -1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N17.
         02 X           PIC S9(17) VALUE -12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N18.
         02 X           PIC S9(18) VALUE -123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       PROCEDURE        DIVISION.
           CALL "dump" USING G-P1.
           CALL "dump" USING G-P2.
           CALL "dump" USING G-P3.
           CALL "dump" USING G-P4.
           CALL "dump" USING G-P5.
           CALL "dump" USING G-P6.
           CALL "dump" USING G-P7.
           CALL "dump" USING G-P8.
           CALL "dump" USING G-P9.
           CALL "dump" USING G-P10.
           CALL "dump" USING G-P11.
           CALL "dump" USING G-P12.
           CALL "dump" USING G-P13.
           CALL "dump" USING G-P14.
           CALL "dump" USING G-P15.
           CALL "dump" USING G-P16.
           CALL "dump" USING G-P17.
           CALL "dump" USING G-P18.
           CALL "dump" USING G-N1.
           CALL "dump" USING G-N2.
           CALL "dump" USING G-N3.
           CALL "dump" USING G-N4.
           CALL "dump" USING G-N5.
           CALL "dump" USING G-N6.
           CALL "dump" USING G-N7.
           CALL "dump" USING G-N8.
           CALL "dump" USING G-N9.
           CALL "dump" USING G-N10.
           CALL "dump" USING G-N11.
           CALL "dump" USING G-N12.
           CALL "dump" USING G-N13.
           CALL "dump" USING G-N14.
           CALL "dump" USING G-N15.
           CALL "dump" USING G-N16.
           CALL "dump" USING G-N17.
           CALL "dump" USING G-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[0131323334353637
0c31323334353637
007b313233343536
04d2313233343536
0000303931323334
0001e24031323334
0012d68731323334
00bc614e31323334
075bcd1531323334
00000000499602d2
00000002dfdc1c35
0000001cbe991a14
0000011f71fb04cb
00000b3a73ce2ff2
00007048860ddf79
000462d53c8abac0
002bdc545d6b4b87
01b69b4ba630f34e
ff31323334353637
f431323334353637
ff85313233343536
fb2e313233343536
ffffcfc731323334
fffe1dc031323334
ffed297931323334
ff439eb231323334
f8a432eb31323334
ffffffffb669fd2e
fffffffd2023e3cb
ffffffe34166e5ec
fffffee08e04fb35
fffff4c58c31d00e
ffff8fb779f22087
fffb9d2ac3754540
ffd423aba294b479
fe4964b459cf0cb2
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[1
12
123
1234
12345
123456
1234567
12345678
123456789
1234567890
12345678901
123456789012
1234567890123
12345678901234
123456789012345
1234567890123456
12345678901234567
123456789012345678
-1
-12
-123
-1234
-12345
-123456
-1234567
-12345678
-123456789
-1234567890
-12345678901
-123456789012
-1234567890123
-12345678901234
-123456789012345
-1234567890123456
-12345678901234567
-123456789012345678
])

AT_CLEANUP


# 1-2-4-8 native

AT_SETUP([1-2-4-8 native])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 1-2-4-8
binary-byteorder: native
])

AT_DATA([dump.c], [
int dump (unsigned char *data)
{
  int i;
  for (i = 0; i < 8; i++)
    printf ("%02x", data[[i]]);
  puts ("");
  return 0;
}
])

AT_CHECK([${CC} -shared -o dump.so dump.c])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 G-P1.
         02 X           PIC 9(1) VALUE 1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P2.
         02 X           PIC 9(2) VALUE 12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P3.
         02 X           PIC 9(3) VALUE 123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P4.
         02 X           PIC 9(4) VALUE 1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P5.
         02 X           PIC 9(5) VALUE 12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P6.
         02 X           PIC 9(6) VALUE 123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P7.
         02 X           PIC 9(7) VALUE 1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P8.
         02 X           PIC 9(8) VALUE 12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P9.
         02 X           PIC 9(9) VALUE 123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P10.
         02 X           PIC 9(10) VALUE 1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P11.
         02 X           PIC 9(11) VALUE 12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P12.
         02 X           PIC 9(12) VALUE 123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P13.
         02 X           PIC 9(13) VALUE 1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P14.
         02 X           PIC 9(14) VALUE 12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P15.
         02 X           PIC 9(15) VALUE 123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P16.
         02 X           PIC 9(16) VALUE 1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P17.
         02 X           PIC 9(17) VALUE 12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P18.
         02 X           PIC 9(18) VALUE 123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N1.
         02 X           PIC S9(1) VALUE -1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N2.
         02 X           PIC S9(2) VALUE -12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N3.
         02 X           PIC S9(3) VALUE -123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N4.
         02 X           PIC S9(4) VALUE -1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N5.
         02 X           PIC S9(5) VALUE -12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N6.
         02 X           PIC S9(6) VALUE -123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N7.
         02 X           PIC S9(7) VALUE -1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N8.
         02 X           PIC S9(8) VALUE -12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N9.
         02 X           PIC S9(9) VALUE -123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N10.
         02 X           PIC S9(10) VALUE -1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N11.
         02 X           PIC S9(11) VALUE -12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N12.
         02 X           PIC S9(12) VALUE -123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N13.
         02 X           PIC S9(13) VALUE -1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N14.
         02 X           PIC S9(14) VALUE -12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N15.
         02 X           PIC S9(15) VALUE -123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N16.
         02 X           PIC S9(16) VALUE -1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N17.
         02 X           PIC S9(17) VALUE -12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N18.
         02 X           PIC S9(18) VALUE -123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       PROCEDURE        DIVISION.
           CALL "dump" USING G-P1.
           CALL "dump" USING G-P2.
           CALL "dump" USING G-P3.
           CALL "dump" USING G-P4.
           CALL "dump" USING G-P5.
           CALL "dump" USING G-P6.
           CALL "dump" USING G-P7.
           CALL "dump" USING G-P8.
           CALL "dump" USING G-P9.
           CALL "dump" USING G-P10.
           CALL "dump" USING G-P11.
           CALL "dump" USING G-P12.
           CALL "dump" USING G-P13.
           CALL "dump" USING G-P14.
           CALL "dump" USING G-P15.
           CALL "dump" USING G-P16.
           CALL "dump" USING G-P17.
           CALL "dump" USING G-P18.
           CALL "dump" USING G-N1.
           CALL "dump" USING G-N2.
           CALL "dump" USING G-N3.
           CALL "dump" USING G-N4.
           CALL "dump" USING G-N5.
           CALL "dump" USING G-N6.
           CALL "dump" USING G-N7.
           CALL "dump" USING G-N8.
           CALL "dump" USING G-N9.
           CALL "dump" USING G-N10.
           CALL "dump" USING G-N11.
           CALL "dump" USING G-N12.
           CALL "dump" USING G-N13.
           CALL "dump" USING G-N14.
           CALL "dump" USING G-N15.
           CALL "dump" USING G-N16.
           CALL "dump" USING G-N17.
           CALL "dump" USING G-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[0131323334353637
0c31323334353637
7b00313233343536
d204313233343536
3930000031323334
40e2010031323334
87d6120031323334
4e61bc0031323334
15cd5b0731323334
d202964900000000
351cdcdf02000000
141a99be1c000000
cb04fb711f010000
f22fce733a0b0000
79df0d8648700000
c0ba8a3cd5620400
874b6b5d54dc2b00
4ef330a64b9bb601
ff31323334353637
f431323334353637
85ff313233343536
2efb313233343536
c7cfffff31323334
c01dfeff31323334
7929edff31323334
b29e43ff31323334
eb32a4f831323334
2efd69b6ffffffff
cbe32320fdffffff
ece56641e3ffffff
35fb048ee0feffff
0ed0318cc5f4ffff
8720f279b78fffff
404575c32a9dfbff
79b494a2ab23d4ff
b20ccf59b46449fe
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[1
12
123
1234
12345
123456
1234567
12345678
123456789
1234567890
12345678901
123456789012
1234567890123
12345678901234
123456789012345
1234567890123456
12345678901234567
123456789012345678
-1
-12
-123
-1234
-12345
-123456
-1234567
-12345678
-123456789
-1234567890
-12345678901
-123456789012
-1234567890123
-12345678901234
-123456789012345
-1234567890123456
-12345678901234567
-123456789012345678
])

AT_CLEANUP


# 1--8 big-endian

AT_SETUP([1--8 big-endian])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 1--8
binary-byteorder: big-endian
])

AT_DATA([dump.c], [
int dump (unsigned char *data)
{
  int i;
  for (i = 0; i < 8; i++)
    printf ("%02x", data[[i]]);
  puts ("");
  return 0;
}
])

AT_CHECK([${CC} -shared -o dump.so dump.c])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 G-P1.
         02 X           PIC 9(1) VALUE 1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P2.
         02 X           PIC 9(2) VALUE 12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P3.
         02 X           PIC 9(3) VALUE 123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P4.
         02 X           PIC 9(4) VALUE 1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P5.
         02 X           PIC 9(5) VALUE 12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P6.
         02 X           PIC 9(6) VALUE 123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P7.
         02 X           PIC 9(7) VALUE 1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P8.
         02 X           PIC 9(8) VALUE 12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P9.
         02 X           PIC 9(9) VALUE 123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P10.
         02 X           PIC 9(10) VALUE 1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P11.
         02 X           PIC 9(11) VALUE 12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P12.
         02 X           PIC 9(12) VALUE 123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P13.
         02 X           PIC 9(13) VALUE 1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P14.
         02 X           PIC 9(14) VALUE 12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P15.
         02 X           PIC 9(15) VALUE 123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P16.
         02 X           PIC 9(16) VALUE 1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P17.
         02 X           PIC 9(17) VALUE 12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P18.
         02 X           PIC 9(18) VALUE 123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N1.
         02 X           PIC S9(1) VALUE -1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N2.
         02 X           PIC S9(2) VALUE -12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N3.
         02 X           PIC S9(3) VALUE -123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N4.
         02 X           PIC S9(4) VALUE -1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N5.
         02 X           PIC S9(5) VALUE -12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N6.
         02 X           PIC S9(6) VALUE -123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N7.
         02 X           PIC S9(7) VALUE -1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N8.
         02 X           PIC S9(8) VALUE -12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N9.
         02 X           PIC S9(9) VALUE -123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N10.
         02 X           PIC S9(10) VALUE -1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N11.
         02 X           PIC S9(11) VALUE -12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N12.
         02 X           PIC S9(12) VALUE -123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N13.
         02 X           PIC S9(13) VALUE -1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N14.
         02 X           PIC S9(14) VALUE -12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N15.
         02 X           PIC S9(15) VALUE -123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N16.
         02 X           PIC S9(16) VALUE -1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N17.
         02 X           PIC S9(17) VALUE -12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N18.
         02 X           PIC S9(18) VALUE -123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       PROCEDURE        DIVISION.
           CALL "dump" USING G-P1.
           CALL "dump" USING G-P2.
           CALL "dump" USING G-P3.
           CALL "dump" USING G-P4.
           CALL "dump" USING G-P5.
           CALL "dump" USING G-P6.
           CALL "dump" USING G-P7.
           CALL "dump" USING G-P8.
           CALL "dump" USING G-P9.
           CALL "dump" USING G-P10.
           CALL "dump" USING G-P11.
           CALL "dump" USING G-P12.
           CALL "dump" USING G-P13.
           CALL "dump" USING G-P14.
           CALL "dump" USING G-P15.
           CALL "dump" USING G-P16.
           CALL "dump" USING G-P17.
           CALL "dump" USING G-P18.
           CALL "dump" USING G-N1.
           CALL "dump" USING G-N2.
           CALL "dump" USING G-N3.
           CALL "dump" USING G-N4.
           CALL "dump" USING G-N5.
           CALL "dump" USING G-N6.
           CALL "dump" USING G-N7.
           CALL "dump" USING G-N8.
           CALL "dump" USING G-N9.
           CALL "dump" USING G-N10.
           CALL "dump" USING G-N11.
           CALL "dump" USING G-N12.
           CALL "dump" USING G-N13.
           CALL "dump" USING G-N14.
           CALL "dump" USING G-N15.
           CALL "dump" USING G-N16.
           CALL "dump" USING G-N17.
           CALL "dump" USING G-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[0131323334353637
0c31323334353637
007b313233343536
04d2313233343536
0030393132333435
01e2403132333435
12d6873132333435
00bc614e31323334
075bcd1531323334
00499602d2313233
02dfdc1c35313233
1cbe991a14313233
011f71fb04cb3132
0b3a73ce2ff23132
007048860ddf7931
0462d53c8abac031
002bdc545d6b4b87
01b69b4ba630f34e
ff31323334353637
f431323334353637
ff85313233343536
fb2e313233343536
ffcfc73132333435
fe1dc03132333435
ffed297931323334
ff439eb231323334
f8a432eb31323334
ffb669fd2e313233
fd2023e3cb313233
ffe34166e5ec3132
fee08e04fb353132
f4c58c31d00e3132
ff8fb779f2208731
fb9d2ac375454031
ffd423aba294b479
fe4964b459cf0cb2
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[1
12
123
1234
12345
123456
1234567
12345678
123456789
1234567890
12345678901
123456789012
1234567890123
12345678901234
123456789012345
1234567890123456
12345678901234567
123456789012345678
-1
-12
-123
-1234
-12345
-123456
-1234567
-12345678
-123456789
-1234567890
-12345678901
-123456789012
-1234567890123
-12345678901234
-123456789012345
-1234567890123456
-12345678901234567
-123456789012345678
])

AT_CLEANUP


# 1--8 native

AT_SETUP([1--8 native])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 1--8
binary-byteorder: native
])

AT_DATA([dump.c], [
int dump (unsigned char *data)
{
  int i;
  for (i = 0; i < 8; i++)
    printf ("%02x", data[[i]]);
  puts ("");
  return 0;
}
])

AT_CHECK([${CC} -shared -o dump.so dump.c])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 G-P1.
         02 X           PIC 9(1) VALUE 1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P2.
         02 X           PIC 9(2) VALUE 12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P3.
         02 X           PIC 9(3) VALUE 123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P4.
         02 X           PIC 9(4) VALUE 1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P5.
         02 X           PIC 9(5) VALUE 12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P6.
         02 X           PIC 9(6) VALUE 123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P7.
         02 X           PIC 9(7) VALUE 1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P8.
         02 X           PIC 9(8) VALUE 12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P9.
         02 X           PIC 9(9) VALUE 123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P10.
         02 X           PIC 9(10) VALUE 1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P11.
         02 X           PIC 9(11) VALUE 12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P12.
         02 X           PIC 9(12) VALUE 123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P13.
         02 X           PIC 9(13) VALUE 1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P14.
         02 X           PIC 9(14) VALUE 12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P15.
         02 X           PIC 9(15) VALUE 123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P16.
         02 X           PIC 9(16) VALUE 1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P17.
         02 X           PIC 9(17) VALUE 12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-P18.
         02 X           PIC 9(18) VALUE 123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N1.
         02 X           PIC S9(1) VALUE -1 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N2.
         02 X           PIC S9(2) VALUE -12 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N3.
         02 X           PIC S9(3) VALUE -123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N4.
         02 X           PIC S9(4) VALUE -1234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N5.
         02 X           PIC S9(5) VALUE -12345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N6.
         02 X           PIC S9(6) VALUE -123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N7.
         02 X           PIC S9(7) VALUE -1234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N8.
         02 X           PIC S9(8) VALUE -12345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N9.
         02 X           PIC S9(9) VALUE -123456789 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N10.
         02 X           PIC S9(10) VALUE -1234567890 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N11.
         02 X           PIC S9(11) VALUE -12345678901 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N12.
         02 X           PIC S9(12) VALUE -123456789012 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N13.
         02 X           PIC S9(13) VALUE -1234567890123 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N14.
         02 X           PIC S9(14) VALUE -12345678901234 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N15.
         02 X           PIC S9(15) VALUE -123456789012345 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N16.
         02 X           PIC S9(16) VALUE -1234567890123456 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N17.
         02 X           PIC S9(17) VALUE -12345678901234567 BINARY.
         02             PIC X(8) VALUE "12345678".
       01 G-N18.
         02 X           PIC S9(18) VALUE -123456789012345678 BINARY.
         02             PIC X(8) VALUE "12345678".
       PROCEDURE        DIVISION.
           CALL "dump" USING G-P1.
           CALL "dump" USING G-P2.
           CALL "dump" USING G-P3.
           CALL "dump" USING G-P4.
           CALL "dump" USING G-P5.
           CALL "dump" USING G-P6.
           CALL "dump" USING G-P7.
           CALL "dump" USING G-P8.
           CALL "dump" USING G-P9.
           CALL "dump" USING G-P10.
           CALL "dump" USING G-P11.
           CALL "dump" USING G-P12.
           CALL "dump" USING G-P13.
           CALL "dump" USING G-P14.
           CALL "dump" USING G-P15.
           CALL "dump" USING G-P16.
           CALL "dump" USING G-P17.
           CALL "dump" USING G-P18.
           CALL "dump" USING G-N1.
           CALL "dump" USING G-N2.
           CALL "dump" USING G-N3.
           CALL "dump" USING G-N4.
           CALL "dump" USING G-N5.
           CALL "dump" USING G-N6.
           CALL "dump" USING G-N7.
           CALL "dump" USING G-N8.
           CALL "dump" USING G-N9.
           CALL "dump" USING G-N10.
           CALL "dump" USING G-N11.
           CALL "dump" USING G-N12.
           CALL "dump" USING G-N13.
           CALL "dump" USING G-N14.
           CALL "dump" USING G-N15.
           CALL "dump" USING G-N16.
           CALL "dump" USING G-N17.
           CALL "dump" USING G-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[0131323334353637
0c31323334353637
7b00313233343536
d204313233343536
3930003132333435
40e2013132333435
87d6123132333435
4e61bc0031323334
15cd5b0731323334
d202964900313233
351cdcdf02313233
141a99be1c313233
cb04fb711f013132
f22fce733a0b3132
79df0d8648700031
c0ba8a3cd5620431
874b6b5d54dc2b00
4ef330a64b9bb601
ff31323334353637
f431323334353637
85ff313233343536
2efb313233343536
c7cfff3132333435
c01dfe3132333435
7929edff31323334
b29e43ff31323334
eb32a4f831323334
2efd69b6ff313233
cbe32320fd313233
ece56641e3ff3132
35fb048ee0fe3132
0ed0318cc5f43132
8720f279b78fff31
404575c32a9dfb31
79b494a2ab23d4ff
b20ccf59b46449fe
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[1
12
123
1234
12345
123456
1234567
12345678
123456789
1234567890
12345678901
123456789012
1234567890123
12345678901234
123456789012345
1234567890123456
12345678901234567
123456789012345678
-1
-12
-123
-1234
-12345
-123456
-1234567
-12345678
-123456789
-1234567890
-12345678901
-123456789012
-1234567890123
-12345678901234
-123456789012345
-1234567890123456
-12345678901234567
-123456789012345678
])

AT_CLEANUP


# full-print

AT_SETUP([full-print])

AT_DATA([test.conf], [
include "cobol2002.conf"
binary-size: 1--8
binary-full-print: yes
])

AT_DATA([prog.cob], [
       IDENTIFICATION   DIVISION.
       PROGRAM-ID.      prog.
       DATA             DIVISION.
       WORKING-STORAGE  SECTION.
       01 X-P1          PIC 9(1) VALUE 1 BINARY.
       01 X-P2          PIC 9(2) VALUE 12 BINARY.
       01 X-P3          PIC 9(3) VALUE 123 BINARY.
       01 X-P4          PIC 9(4) VALUE 1234 BINARY.
       01 X-P5          PIC 9(5) VALUE 12345 BINARY.
       01 X-P6          PIC 9(6) VALUE 123456 BINARY.
       01 X-P7          PIC 9(7) VALUE 1234567 BINARY.
       01 X-P8          PIC 9(8) VALUE 12345678 BINARY.
       01 X-P9          PIC 9(9) VALUE 123456789 BINARY.
       01 X-P10         PIC 9(10) VALUE 1234567890 BINARY.
       01 X-P11         PIC 9(11) VALUE 12345678901 BINARY.
       01 X-P12         PIC 9(12) VALUE 123456789012 BINARY.
       01 X-P13         PIC 9(13) VALUE 1234567890123 BINARY.
       01 X-P14         PIC 9(14) VALUE 12345678901234 BINARY.
       01 X-P15         PIC 9(15) VALUE 123456789012345 BINARY.
       01 X-P16         PIC 9(16) VALUE 1234567890123456 BINARY.
       01 X-P17         PIC 9(17) VALUE 12345678901234567 BINARY.
       01 X-P18         PIC 9(18) VALUE 123456789012345678 BINARY.
       01 X-N1          PIC S9(1) VALUE -1 BINARY.
       01 X-N2          PIC S9(2) VALUE -12 BINARY.
       01 X-N3          PIC S9(3) VALUE -123 BINARY.
       01 X-N4          PIC S9(4) VALUE -1234 BINARY.
       01 X-N5          PIC S9(5) VALUE -12345 BINARY.
       01 X-N6          PIC S9(6) VALUE -123456 BINARY.
       01 X-N7          PIC S9(7) VALUE -1234567 BINARY.
       01 X-N8          PIC S9(8) VALUE -12345678 BINARY.
       01 X-N9          PIC S9(9) VALUE -123456789 BINARY.
       01 X-N10         PIC S9(10) VALUE -1234567890 BINARY.
       01 X-N11         PIC S9(11) VALUE -12345678901 BINARY.
       01 X-N12         PIC S9(12) VALUE -123456789012 BINARY.
       01 X-N13         PIC S9(13) VALUE -1234567890123 BINARY.
       01 X-N14         PIC S9(14) VALUE -12345678901234 BINARY.
       01 X-N15         PIC S9(15) VALUE -123456789012345 BINARY.
       01 X-N16         PIC S9(16) VALUE -1234567890123456 BINARY.
       01 X-N17         PIC S9(17) VALUE -12345678901234567 BINARY.
       01 X-N18         PIC S9(18) VALUE -123456789012345678 BINARY.
       PROCEDURE        DIVISION.
           DISPLAY X-P1.
           DISPLAY X-P2.
           DISPLAY X-P3.
           DISPLAY X-P4.
           DISPLAY X-P5.
           DISPLAY X-P6.
           DISPLAY X-P7.
           DISPLAY X-P8.
           DISPLAY X-P9.
           DISPLAY X-P10.
           DISPLAY X-P11.
           DISPLAY X-P12.
           DISPLAY X-P13.
           DISPLAY X-P14.
           DISPLAY X-P15.
           DISPLAY X-P16.
           DISPLAY X-P17.
           DISPLAY X-P18.
           DISPLAY X-N1.
           DISPLAY X-N2.
           DISPLAY X-N3.
           DISPLAY X-N4.
           DISPLAY X-N5.
           DISPLAY X-N6.
           DISPLAY X-N7.
           DISPLAY X-N8.
           DISPLAY X-N9.
           DISPLAY X-N10.
           DISPLAY X-N11.
           DISPLAY X-N12.
           DISPLAY X-N13.
           DISPLAY X-N14.
           DISPLAY X-N15.
           DISPLAY X-N16.
           DISPLAY X-N17.
           DISPLAY X-N18.
           STOP RUN.
])

AT_CHECK([${COMPILE} -conf=test.conf -o prog prog.cob])
AT_CHECK([./prog], [0],
[001
012
00123
01234
0012345
0123456
1234567
0012345678
0123456789
001234567890
012345678901
123456789012
001234567890123
012345678901234
00123456789012345
01234567890123456
0012345678901234567
0123456789012345678
-001
-012
-00123
-01234
-0012345
-0123456
-0001234567
-0012345678
-0123456789
-001234567890
-012345678901
-000123456789012
-001234567890123
-012345678901234
-00123456789012345
-01234567890123456
-0012345678901234567
-0123456789012345678
])

AT_CLEANUP
