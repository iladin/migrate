## Various name definitions and references


###
### Data name
###

## Undefined

AT_SETUP([Undefined entry])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       PROCEDURE       DIVISION.
         DISPLAY X.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:5: `X' undefined
])

AT_CLEANUP

AT_SETUP([Undefined group])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 X            PIC X.
       PROCEDURE       DIVISION.
         DISPLAY X IN G.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:8: `G' undefined
])

AT_CLEANUP

AT_SETUP([Undefined in the group])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 G.
         02 X          PIC X.
       01 Y            PIC X.
       PROCEDURE       DIVISION.
         DISPLAY Y IN G.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:10: `Y' undefined in `G'
])

AT_CLEANUP

AT_SETUP([Reference not a group])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 X            PIC X.
       PROCEDURE       DIVISION.
         DISPLAY X IN X.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:8: `X' not a group
])

AT_CLEANUP


## Incomplete

AT_SETUP([Incomplete 01 definition])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 X.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:6: PICTURE clause required for `X'
])

AT_CLEANUP


## Redefinition

AT_SETUP([Redefinition of 01 entries])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 X            PIC X.
       01 X            PIC X.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:7: redefinition of `X'
prog.cob:6: `X' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of 01 and 02 entries])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 X.
         02 X          PIC X.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:7: redefinition of `X'
prog.cob:6: `X' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of 02 entries in the same group])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 G.
         02 X          PIC X.
         02 X          PIC X.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:8: redefinition of `X'
prog.cob:7: `X' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of 02 entries in different groups])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 G1.
         02 X          PIC X.
       01 G2.
         02 X          PIC X.
       PROCEDURE       DIVISION.
         DISPLAY X.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:11: `X' ambiguous; need qualification
prog.cob:7: `X' in `G1' defined here
prog.cob:9: `X' in `G2' defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of 02 and 03 entries])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 G.
         02 X.
           03 X        PIC X.
       PROCEDURE       DIVISION.
         DISPLAY X.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:10: `X' ambiguous; need qualification
prog.cob:7: `X' in `G' defined here
prog.cob:8: `X' in `X' in `G' defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of 77 entries])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       77 X            PIC X.
       77 X            PIC X.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:7: redefinition of `X'
prog.cob:6: `X' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of 01 and 77 entries])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       DATA            DIVISION.
       WORKING-STORAGE SECTION.
       01 X            PIC X.
       77 X            PIC X.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:7: redefinition of `X'
prog.cob:6: `X' previously defined here
])

AT_CLEANUP


###
### File name
###


###
### Label name
###

## Undefined

AT_SETUP([Undefined label])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       PROCEDURE       DIVISION.
         GO TO END-OF-PROGRAM.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob:5: `END-OF-PROGRAM' undefined
])

AT_CLEANUP


## Redefinition

AT_SETUP([Redefinition of section label])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       PROCEDURE       DIVISION.
       L SECTION.
       L SECTION.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob: In section `L':
prog.cob:6: redefinition of `L'
prog.cob:5: `L' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of section and paragraph label])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       PROCEDURE       DIVISION.
       L SECTION.
       L.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob: In section `L':
prog.cob:6: redefinition of `L'
prog.cob:5: `L' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of paragraph label in the same section])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       PROCEDURE       DIVISION.
       L.
       L.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob: In paragraph `L':
prog.cob:6: redefinition of `L'
prog.cob:5: `L' previously defined here
])

AT_CLEANUP

AT_SETUP([Redefinition of paragraph label in deferent sections])

AT_DATA([prog.cob], [
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     prog.
       PROCEDURE       DIVISION.
       S-1 SECTION.
       L.
       S-2 SECTION.
       L.
       S-3 SECTION.
         GO TO L.
         STOP RUN.
])

AT_CHECK([${COMPILE_ONLY} prog.cob], [1], ,
[prog.cob: In section `S-3':
prog.cob:10: `L' ambiguous; need qualification
prog.cob:6: `L' in `S-1' defined here
prog.cob:8: `L' in `S-2' defined here
])

AT_CLEANUP


###
### Special name
###
